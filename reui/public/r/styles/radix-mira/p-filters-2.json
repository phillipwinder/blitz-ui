{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"p-filters-2","type":"registry:block","title":"Filters with input validation","description":"Filters with input validation","dependencies":["zod"],"registryDependencies":["button","https://reui.io/r/styles/radix-mira/filters.json"],"files":[{"path":"p-filters-2.tsx","type":"registry:block","content":"\"use client\"\n\nimport { useCallback, useState } from \"react\"\nimport {\n  createFilter,\n  Filters,\n  type Filter,\n  type FilterFieldConfig,\n} from \"@/components/reui/filters\"\nimport { z } from \"zod\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { IconPlaceholder } from \"@/app/(create)/components/icon-placeholder\"\n\n// Zod validation helper - wraps a Zod schema to return validation result with message\nfunction zodValidator<T extends z.ZodType>(schema: T) {\n  return (value: unknown): { valid: boolean; message?: string } => {\n    const result = schema.safeParse(value)\n    if (result.success) {\n      return { valid: true }\n    }\n    // Get the first error message from Zod using format()\n    const formatted = result.error.format()\n    const message =\n      formatted._errors?.[0] || result.error.message || \"Invalid value\"\n    return { valid: false, message }\n  }\n}\n\n// Define Zod schemas for different field types\nconst emailSchema = z\n  .string()\n  .min(1, { message: \"Email is required\" })\n  .pipe(z.email({ message: \"Please enter a valid email address\" }))\n\nconst urlSchema = z\n  .string()\n  .pipe(\n    z.url({ message: \"Please enter a valid URL (e.g., https://example.com)\" })\n  )\n\nconst phoneSchema = z\n  .string()\n  .regex(/^\\+?[1-9]\\d{1,14}$/, { message: \"Please enter a valid phone number\" })\n\nconst usernameSchema = z\n  .string()\n  .min(3, { message: \"Username must be at least 3 characters\" })\n  .max(20, { message: \"Username must be at most 20 characters\" })\n  .regex(/^[a-zA-Z0-9_]+$/, {\n    message: \"Username can only contain letters, numbers, and underscores\",\n  })\n\nconst creditCardSchema = z.string().regex(/^\\d{13,19}$/, {\n  message: \"Please enter a valid credit card number (13-19 digits)\",\n})\n\nexport function Pattern() {\n  const fields: FilterFieldConfig[] = [\n    {\n      key: \"email\",\n      label: \"Email\",\n      icon: (\n        <IconPlaceholder\n          lucide=\"AtSignIcon\"\n          tabler=\"IconAt\"\n          hugeicons=\"AtIcon\"\n          phosphor=\"AtIcon\"\n          remixicon=\"RiAtLine\"\n          className=\"size-3.5\"\n        />\n      ),\n      type: \"text\",\n      placeholder: \"user@example.com\",\n      // Use Zod validator for email validation\n      validation: zodValidator(emailSchema),\n    },\n    {\n      key: \"website\",\n      label: \"Website\",\n      icon: (\n        <IconPlaceholder\n          lucide=\"GlobeIcon\"\n          tabler=\"IconWorld\"\n          hugeicons=\"Globe02Icon\"\n          phosphor=\"GlobeSimpleIcon\"\n          remixicon=\"RiGlobalLine\"\n          className=\"size-3.5\"\n        />\n      ),\n      type: \"text\",\n      placeholder: \"https://example.com\",\n      // Use Zod validator for URL validation\n      validation: zodValidator(urlSchema),\n    },\n    {\n      key: \"phone\",\n      label: \"Phone\",\n      icon: (\n        <IconPlaceholder\n          lucide=\"PhoneIcon\"\n          tabler=\"IconPhone\"\n          hugeicons=\"Call02Icon\"\n          phosphor=\"PhoneIcon\"\n          remixicon=\"RiPhoneLine\"\n          className=\"size-3.5\"\n        />\n      ),\n      type: \"text\",\n      placeholder: \"+1234567890\",\n      // Use Zod validator for phone validation\n      validation: zodValidator(phoneSchema),\n    },\n    {\n      key: \"username\",\n      label: \"Username\",\n      icon: (\n        <IconPlaceholder\n          lucide=\"UserIcon\"\n          tabler=\"IconUser\"\n          hugeicons=\"UserIcon\"\n          phosphor=\"UserIcon\"\n          remixicon=\"RiUserLine\"\n          className=\"size-3.5\"\n        />\n      ),\n      type: \"text\",\n      className: \"w-44\",\n      placeholder: \"john_doe\",\n      // Use Zod validator for username validation\n      validation: zodValidator(usernameSchema),\n    },\n    {\n      key: \"cardNumber\",\n      label: \"Card Number\",\n      icon: (\n        <IconPlaceholder\n          lucide=\"CreditCardIcon\"\n          tabler=\"IconCreditCard\"\n          hugeicons=\"CreditCardIcon\"\n          phosphor=\"CreditCardIcon\"\n          remixicon=\"RiBankCardLine\"\n          className=\"size-3.5\"\n        />\n      ),\n      type: \"text\",\n      placeholder: \"4111111111111111\",\n      // Use Zod validator for credit card validation\n      validation: zodValidator(creditCardSchema),\n    },\n    {\n      key: \"customUrl\",\n      label: \"Custom URL\",\n      icon: (\n        <IconPlaceholder\n          lucide=\"LinkIcon\"\n          tabler=\"IconLink\"\n          hugeicons=\"Link01Icon\"\n          phosphor=\"LinkIcon\"\n          remixicon=\"RiLinkM\"\n          className=\"size-3.5\"\n        />\n      ),\n      type: \"text\",\n      placeholder: \"https://...\",\n      // Custom validation function without Zod (for comparison)\n      validation: (value) => {\n        const urlPattern = /^https?:\\/\\/.+\\..+/\n        if (!urlPattern.test(value as string)) {\n          return {\n            valid: false,\n            message: \"URL must start with http:// or https://\",\n          }\n        }\n        return { valid: true }\n      },\n    },\n  ]\n\n  const [filters, setFilters] = useState<Filter[]>([\n    createFilter(\"email\", \"contains\", [\"\"]),\n  ])\n\n  const handleFiltersChange = useCallback((filters: Filter[]) => {\n    setFilters(filters)\n  }, [])\n\n  return (\n    <div className=\"flex grow content-start items-start self-start\">\n      <Filters\n        filters={filters}\n        fields={fields}\n        trigger={\n          <Button variant=\"outline\" size=\"icon\">\n            <IconPlaceholder\n              lucide=\"ListFilterIcon\"\n              tabler=\"IconFilter2\"\n              hugeicons=\"FilterMailIcon\"\n              phosphor=\"FunnelSimpleIcon\"\n              remixicon=\"RiFilter3Line\"\n            />\n          </Button>\n        }\n        onChange={handleFiltersChange}\n      />\n    </div>\n  )\n}","target":"components/patterns/p-filters-2.tsx"}]}