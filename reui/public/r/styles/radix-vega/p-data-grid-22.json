{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"p-data-grid-22","type":"registry:block","title":"Data grid with CRUD features","description":"Data grid with CRUD features","dependencies":["@tanstack/react-table","sonner"],"registryDependencies":["avatar","https://reui.io/r/styles/radix-vega/badge.json","button","card","checkbox","https://reui.io/r/styles/radix-vega/data-grid.json","dropdown-menu","input-group","label","popover","scroll-area","https://reui.io/r/styles/radix-vega/use-copy-to-clipboard.json"],"files":[{"path":"p-data-grid-22.tsx","type":"registry:block","content":"\"use client\"\n\nimport { useMemo, useState } from \"react\"\nimport { useCopyToClipboard } from \"@/hooks/use-copy-to-clipboard\"\nimport { Badge } from \"@/components/reui/badge\"\nimport { DataGrid } from \"@/components/reui/data-grid/data-grid\"\nimport { DataGridColumnHeader } from \"@/components/reui/data-grid/data-grid-column-header\"\nimport { DataGridPagination } from \"@/components/reui/data-grid/data-grid-pagination\"\nimport {\n  DataGridTable,\n  DataGridTableRowSelect,\n  DataGridTableRowSelectAll,\n} from \"@/components/reui/data-grid/data-grid-table\"\nimport {\n  ColumnDef,\n  getCoreRowModel,\n  getFilteredRowModel,\n  getPaginationRowModel,\n  getSortedRowModel,\n  PaginationState,\n  Row,\n  SortingState,\n  useReactTable,\n} from \"@tanstack/react-table\"\nimport { toast } from \"sonner\"\n\nimport {\n  Avatar,\n  AvatarFallback,\n  AvatarImage,\n} from \"@/components/ui/avatar\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Card,\n  CardAction,\n  CardContent,\n  CardFooter,\n  CardHeader,\n} from \"@/components/ui/card\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupInput,\n} from \"@/components/ui/input-group\"\nimport { Label } from \"@/components/ui/label\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\nimport { ScrollArea, ScrollBar } from \"@/components/ui/scroll-area\"\nimport { IconPlaceholder } from \"@/app/(create)/components/icon-placeholder\"\n\ninterface IData {\n  id: string\n  name: string\n  availability: \"online\" | \"away\" | \"busy\" | \"offline\"\n  avatar: string\n  status: \"Active\" | \"Inactive\" | \"Pending\" | \"Blocked\"\n  flag: string // Emoji flags\n  email: string\n  company: string\n  role: string\n  joined: string\n  location: string\n  balance: number\n}\n\nconst demoData: IData[] = [\n  {\n    id: \"1\",\n    name: \"Alex Johnson\",\n    availability: \"online\",\n    avatar:\n      \"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=96&h=96&dpr=2&q=80\",\n    status: \"Active\",\n    flag: \"us\",\n    email: \"alex@apple.com\",\n    company: \"Apple\",\n    role: \"CEO\",\n    joined: \"Jan, 2024\",\n    location: \"United States\",\n    balance: 5143.03,\n  },\n  {\n    id: \"2\",\n    name: \"Sarah Chen\",\n    availability: \"away\",\n    avatar:\n      \"https://images.unsplash.com/photo-1519699047748-de8e457a634e?w=96&h=96&dpr=2&q=80\",\n    status: \"Inactive\",\n    flag: \"gb\",\n    email: \"sarah@openai.com\",\n    company: \"OpenAI\",\n    role: \"CTO\",\n    joined: \"Mar, 2023\",\n    location: \"United Kingdom\",\n    balance: 4321.87,\n  },\n  {\n    id: \"3\",\n    name: \"Michael Rodriguez\",\n    availability: \"busy\",\n    avatar:\n      \"https://images.unsplash.com/photo-1584308972272-9e4e7685e80f?w=96&h=96&dpr=2&q=80\",\n    status: \"Blocked\",\n    flag: \"ca\",\n    email: \"michael@meta.com\",\n    company: \"Meta\",\n    role: \"Designer\",\n    joined: \"Jun, 2022\",\n    location: \"Canada\",\n    balance: 7654.98,\n  },\n  {\n    id: \"4\",\n    name: \"Emma Wilson\",\n    availability: \"offline\",\n    avatar:\n      \"https://images.unsplash.com/photo-1485893086445-ed75865251e0?w=96&h=96&dpr=2&q=80\",\n    status: \"Inactive\",\n    flag: \"au\",\n    email: \"emma@tesla.com\",\n    company: \"Tesla\",\n    role: \"Developer\",\n    joined: \"Sep, 2024\",\n    location: \"Australia\",\n    balance: 3456.45,\n  },\n  {\n    id: \"5\",\n    name: \"David Kim\",\n    availability: \"online\",\n    avatar:\n      \"https://images.unsplash.com/photo-1607990281513-2c110a25bd8c?w=96&h=96&dpr=2&q=80\",\n    status: \"Active\",\n    flag: \"de\",\n    email: \"david@sap.com\",\n    company: \"SAP\",\n    role: \"Lawyer\",\n    joined: \"Nov, 2023\",\n    location: \"Germany\",\n    balance: 9876.54,\n  },\n  {\n    id: \"6\",\n    name: \"Aron Thompson\",\n    availability: \"away\",\n    avatar:\n      \"https://images.unsplash.com/photo-1527980965255-d3b416303d12?w=96&h=96&dpr=2&q=80\",\n    status: \"Pending\",\n    flag: \"my\",\n    email: \"aron@keenthemes.com\",\n    company: \"Keenthemes\",\n    role: \"Director\",\n    joined: \"Feb, 2022\",\n    location: \"Malaysia\",\n    balance: 6214.22,\n  },\n  {\n    id: \"7\",\n    name: \"James Brown\",\n    availability: \"busy\",\n    avatar:\n      \"https://images.unsplash.com/photo-1543299750-19d1d6297053?w=96&h=96&dpr=2&q=80\",\n    status: \"Inactive\",\n    flag: \"es\",\n    email: \"james@bbva.es\",\n    company: \"BBVA\",\n    role: \"Product Manager\",\n    joined: \"Aug, 2024\",\n    location: \"Spain\",\n    balance: 5321.77,\n  },\n  {\n    id: \"8\",\n    name: \"Maria Garcia\",\n    availability: \"offline\",\n    avatar:\n      \"https://images.unsplash.com/photo-1620075225255-8c2051b6c015?w=96&h=96&dpr=2&q=80\",\n    status: \"Blocked\",\n    flag: \"jp\",\n    email: \"maria@sony.jp\",\n    company: \"Sony\",\n    role: \"Marketing Lead\",\n    joined: \"Dec, 2023\",\n    location: \"Japan\",\n    balance: 8452.39,\n  },\n  {\n    id: \"9\",\n    name: \"Nick Johnson\",\n    availability: \"online\",\n    avatar:\n      \"https://images.unsplash.com/photo-1485206412256-701ccc5b93ca?w=96&h=96&dpr=2&q=80\",\n    status: \"Pending\",\n    flag: \"fr\",\n    email: \"nick@lvmh.fr\",\n    company: \"LVMH\",\n    role: \"Data Scientist\",\n    joined: \"Apr, 2022\",\n    location: \"France\",\n    balance: 7345.1,\n  },\n  {\n    id: \"10\",\n    name: \"Liam Thompson\",\n    availability: \"away\",\n    avatar:\n      \"https://images.unsplash.com/photo-1542595913-85d69b0edbaf?w=96&h=96&dpr=2&q=80\",\n    status: \"Inactive\",\n    flag: \"it\",\n    email: \"liam@eni.it\",\n    company: \"ENI\",\n    role: \"Engineer\",\n    joined: \"Jul, 2024\",\n    location: \"Italy\",\n    balance: 5214.88,\n  },\n  {\n    id: \"11\",\n    name: \"Alex Johnson\",\n    availability: \"busy\",\n    avatar:\n      \"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=96&h=96&dpr=2&q=80\",\n    status: \"Blocked\",\n    flag: \"br\",\n    email: \"alex@vale.br\",\n    company: \"Vale\",\n    role: \"Software Engineer\",\n    joined: \"May, 2023\",\n    location: \"Brazil\",\n    balance: 9421.5,\n  },\n  {\n    id: \"12\",\n    name: \"Sarah Chen\",\n    availability: \"offline\",\n    avatar:\n      \"https://images.unsplash.com/photo-1519699047748-de8e457a634e?w=96&h=96&dpr=2&q=80\",\n    status: \"Active\",\n    flag: \"in\",\n    email: \"sarah@tata.in\",\n    company: \"Tata\",\n    role: \"Sales Manager\",\n    joined: \"Oct, 2024\",\n    location: \"India\",\n    balance: 4521.67,\n  },\n]\n\nfunction ActionsCell({ row }: { row: Row<IData> }) {\n  const { copyToClipboard } = useCopyToClipboard()\n  const handleCopyId = () => {\n    copyToClipboard(row.original.id)\n\n    toast.success(\"Employee ID successfully copied\", {\n      description: row.original.id,\n    })\n  }\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button className=\"size-7\" size=\"icon\" variant=\"ghost\">\n          <IconPlaceholder\n            lucide=\"MoreHorizontalIcon\"\n            tabler=\"IconDots\"\n            hugeicons=\"MoreHorizontalCircle01Icon\"\n            phosphor=\"DotsThreeIcon\"\n            remixicon=\"RiMoreLine\"\n          />\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent side=\"bottom\" align=\"start\">\n        <DropdownMenuItem onClick={() => {}}>Edit</DropdownMenuItem>\n        <DropdownMenuItem onClick={handleCopyId}>Copy ID</DropdownMenuItem>\n        <DropdownMenuSeparator />\n        <DropdownMenuItem variant=\"destructive\" onClick={() => {}}>\n          Delete\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  )\n}\n\nexport function Pattern() {\n  const [pagination, setPagination] = useState<PaginationState>({\n    pageIndex: 0,\n    pageSize: 5,\n  })\n  const [sorting, setSorting] = useState<SortingState>([\n    { id: \"name\", desc: true },\n  ])\n  const [searchQuery, setSearchQuery] = useState(\"\")\n  const [selectedStatuses, setSelectedStatuses] = useState<string[]>([])\n\n  const filteredData = useMemo(() => {\n    return demoData.filter((item) => {\n      // Filter by status\n      const matchesStatus =\n        !selectedStatuses?.length || selectedStatuses.includes(item.status)\n\n      // Filter by search query (case-insensitive)\n      const searchLower = searchQuery.toLowerCase()\n      const matchesSearch =\n        !searchQuery ||\n        Object.values(item)\n          .join(\" \") // Combine all fields into a single string\n          .toLowerCase()\n          .includes(searchLower)\n\n      return matchesStatus && matchesSearch\n    })\n  }, [searchQuery, selectedStatuses])\n\n  const statusCounts = useMemo(() => {\n    return demoData.reduce(\n      (acc, item) => {\n        acc[item.status] = (acc[item.status] || 0) + 1\n        return acc\n      },\n      {} as Record<string, number>\n    )\n  }, [])\n\n  const handleStatusChange = (checked: boolean, value: string) => {\n    setSelectedStatuses(\n      (\n        prev = [] // Default to an empty array\n      ) => (checked ? [...prev, value] : prev.filter((v) => v !== value))\n    )\n  }\n\n  const columns = useMemo<ColumnDef<IData>[]>(\n    () => [\n      {\n        accessorKey: \"id\",\n        id: \"id\",\n        header: () => <DataGridTableRowSelectAll />,\n        cell: ({ row }) => <DataGridTableRowSelect row={row} />,\n        enableSorting: false,\n        size: 35,\n        meta: {\n          headerClassName: \"\",\n          cellClassName: \"\",\n        },\n        enableResizing: false,\n      },\n      {\n        accessorKey: \"name\",\n        id: \"name\",\n        header: ({ column }) => (\n          <DataGridColumnHeader\n            title=\"User\"\n            visibility={true}\n            column={column}\n          />\n        ),\n        cell: ({ row }) => {\n          return (\n            <div className=\"flex items-center gap-3\">\n              <Avatar className=\"size-8\">\n                <AvatarImage\n                  src={row.original.avatar}\n                  alt={row.original.name}\n                />\n                <AvatarFallback>\n                  {row.original.name\n                    .split(\" \")\n                    .map((n) => n[0])\n                    .join(\"\")}\n                </AvatarFallback>\n              </Avatar>\n              <div className=\"space-y-px\">\n                <div className=\"text-foreground font-medium\">\n                  {row.original.name}\n                </div>\n                <div className=\"text-muted-foreground\">\n                  {row.original.email}\n                </div>\n              </div>\n            </div>\n          )\n        },\n        size: 200,\n        enableSorting: true,\n        enableHiding: false,\n        enableResizing: true,\n      },\n      {\n        accessorKey: \"location\",\n        id: \"location\",\n        header: ({ column }) => (\n          <DataGridColumnHeader\n            title=\"Location\"\n            visibility={true}\n            column={column}\n          />\n        ),\n        cell: ({ row }) => {\n          return (\n            <div className=\"flex items-center gap-1.5\">\n              <img\n                src={`https://flagcdn.com/${row.original.flag.toLowerCase()}.svg`}\n                alt={row.original.flag}\n                className=\"size-4 rounded-full object-cover\"\n              />\n              <div className=\"text-foreground font-medium\">\n                {row.original.location}\n              </div>\n            </div>\n          )\n        },\n        size: 150,\n        meta: {\n          headerClassName: \"\",\n          cellClassName: \"text-start\",\n        },\n        enableSorting: true,\n        enableHiding: true,\n        enableResizing: true,\n      },\n      {\n        accessorKey: \"role\",\n        id: \"role\",\n        header: ({ column }) => (\n          <DataGridColumnHeader\n            title=\"Role\"\n            visibility={true}\n            column={column}\n          />\n        ),\n        cell: ({ row }) => {\n          return (\n            <div className=\"text-foreground font-medium\">\n              {row.original.role}\n            </div>\n          )\n        },\n        size: 150,\n        enableSorting: true,\n        enableHiding: true,\n        enableResizing: true,\n      },\n      {\n        accessorKey: \"joined\",\n        id: \"joined\",\n        header: ({ column }) => (\n          <DataGridColumnHeader\n            title=\"Joined\"\n            visibility={true}\n            column={column}\n          />\n        ),\n        cell: ({ row }) => {\n          return (\n            <div className=\"text-foreground font-medium\">\n              {row.original.joined}\n            </div>\n          )\n        },\n        size: 150,\n        enableSorting: true,\n        enableHiding: true,\n        enableResizing: true,\n      },\n      {\n        accessorKey: \"status\",\n        id: \"status\",\n        header: ({ column }) => (\n          <DataGridColumnHeader\n            title=\"Status\"\n            visibility={true}\n            column={column}\n          />\n        ),\n        cell: ({ row }) => {\n          const status = row.original.status\n\n          if (status == \"Active\") {\n            return <Badge variant=\"success-outline\">Approved</Badge>\n          } else if (status == \"Blocked\") {\n            return <Badge variant=\"destructive-outline\">Blocked</Badge>\n          } else if (status == \"Inactive\") {\n            return <Badge variant=\"info-outline\">Inactive</Badge>\n          } else {\n            return <Badge variant=\"warning-outline\">Pending</Badge>\n          }\n        },\n        size: 100,\n        enableSorting: true,\n        enableHiding: true,\n        enableResizing: true,\n      },\n      {\n        id: \"actions\",\n        header: \"\",\n        cell: ({ row }) => <ActionsCell row={row} />,\n        size: 60,\n        enableSorting: false,\n        enableHiding: false,\n        enableResizing: false,\n      },\n    ],\n    []\n  )\n\n  const [columnOrder, setColumnOrder] = useState<string[]>(\n    columns.map((column) => column.id as string)\n  )\n\n  const table = useReactTable({\n    columns,\n    data: filteredData,\n    pageCount: Math.ceil((filteredData?.length || 0) / pagination.pageSize),\n    getRowId: (row: IData) => row.id,\n    state: {\n      pagination,\n      sorting,\n      columnOrder,\n    },\n    columnResizeMode: \"onChange\",\n    onColumnOrderChange: setColumnOrder,\n    onPaginationChange: setPagination,\n    onSortingChange: setSorting,\n    getCoreRowModel: getCoreRowModel(),\n    getFilteredRowModel: getFilteredRowModel(),\n    getPaginationRowModel: getPaginationRowModel(),\n    getSortedRowModel: getSortedRowModel(),\n  })\n\n  return (\n    <DataGrid\n      table={table}\n      recordCount={filteredData?.length || 0}\n      tableLayout={{\n        columnsPinnable: true,\n        columnsResizable: true,\n        columnsMovable: true,\n        columnsVisibility: true,\n      }}\n    >\n      <Card className=\"w-full gap-3 py-3.5\">\n        <CardHeader className=\"justify-between px-3.5\">\n          <div className=\"flex items-center gap-2.5\">\n            <InputGroup className=\"w-48\">\n              <InputGroupAddon align=\"inline-start\">\n                <IconPlaceholder\n                  lucide=\"SearchIcon\"\n                  tabler=\"IconSearch\"\n                  hugeicons=\"Search01Icon\"\n                  phosphor=\"MagnifyingGlassIcon\"\n                  remixicon=\"RiSearchLine\"\n                />\n              </InputGroupAddon>\n\n              <InputGroupInput\n                placeholder=\"Search...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n\n              {searchQuery.length > 0 && (\n                <InputGroupAddon align=\"inline-end\">\n                  <InputGroupButton\n                    aria-label=\"Copy\"\n                    title=\"Copy\"\n                    size=\"icon-xs\"\n                    onClick={() => setSearchQuery(\"\")}\n                  >\n                    <IconPlaceholder\n                      lucide=\"XIcon\"\n                      tabler=\"IconX\"\n                      hugeicons=\"MultiplicationSignIcon\"\n                      phosphor=\"XIcon\"\n                      remixicon=\"RiCloseLine\"\n                    />\n                  </InputGroupButton>\n                </InputGroupAddon>\n              )}\n            </InputGroup>\n            <Popover>\n              <PopoverTrigger asChild>\n                <Button variant=\"outline\">\n                  <IconPlaceholder\n                    lucide=\"FunnelIcon\"\n                    tabler=\"IconFilter\"\n                    hugeicons=\"FilterIcon\"\n                    phosphor=\"FunnelIcon\"\n                    remixicon=\"RiFilter2Line\"\n                  />\n                  Status\n                  {selectedStatuses.length > 0 && (\n                    <Badge size=\"sm\" variant=\"info-outline\">\n                      {selectedStatuses.length}\n                    </Badge>\n                  )}\n                </Button>\n              </PopoverTrigger>\n              <PopoverContent className=\"w-40\" align=\"start\">\n                <div className=\"space-y-3\">\n                  <div className=\"text-muted-foreground text-xs font-medium\">\n                    Filters\n                  </div>\n                  <div className=\"space-y-3\">\n                    {Object.keys(statusCounts).map((status) => (\n                      <div key={status} className=\"flex items-center gap-2.5\">\n                        <Checkbox\n                          id={status}\n                          checked={selectedStatuses.includes(status)}\n                          onCheckedChange={(checked) =>\n                            handleStatusChange(checked === true, status)\n                          }\n                        />\n                        <Label\n                          htmlFor={status}\n                          className=\"flex grow items-center justify-between gap-1.5 font-normal\"\n                        >\n                          {status}\n                          <span className=\"text-muted-foreground\">\n                            {statusCounts[status]}\n                          </span>\n                        </Label>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </PopoverContent>\n            </Popover>\n          </div>\n          <CardAction>\n            <Button>\n              <IconPlaceholder\n                lucide=\"UserPlusIcon\"\n                tabler=\"IconUserPlus\"\n                hugeicons=\"UserAdd01Icon\"\n                phosphor=\"UserPlusIcon\"\n                remixicon=\"RiUserAddLine\"\n              />\n              Add new\n            </Button>\n          </CardAction>\n        </CardHeader>\n        <CardContent className=\"border-y px-0\">\n          <ScrollArea>\n            <DataGridTable />\n            <ScrollBar orientation=\"horizontal\" />\n          </ScrollArea>\n        </CardContent>\n        <CardFooter className=\"border-none px-3.5 py-0\">\n          <DataGridPagination />\n        </CardFooter>\n      </Card>\n    </DataGrid>\n  )\n}","target":"components/patterns/p-data-grid-22.tsx"}]}