{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"p-file-upload-10","type":"registry:block","title":"Cover image upload.","description":"Cover image upload.","dependencies":[],"registryDependencies":["https://reui.io/r/styles/radix-maia/alert.json","button","https://reui.io/r/styles/radix-maia/use-file-upload.json"],"files":[{"path":"p-file-upload-10.tsx","type":"registry:block","content":"\"use client\"\n\nimport { useState } from \"react\"\nimport {\n  useFileUpload,\n  type FileMetadata,\n  type FileWithPreview,\n} from \"@/hooks/use-file-upload\"\nimport {\n  Alert,\n  AlertDescription,\n  AlertTitle,\n} from \"@/components/reui/alert\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { IconPlaceholder } from \"@/app/(create)/components/icon-placeholder\"\n\ninterface CoverUploadProps {\n  maxSize?: number\n  accept?: string\n  className?: string\n  onImageChange?: (file: File | null) => void\n}\n\nexport function Pattern({\n  maxSize = 5 * 1024 * 1024, // 5MB default\n  accept = \"image/*\",\n  className,\n  onImageChange,\n}: CoverUploadProps) {\n  // Default cover image\n  const defaultCoverImage: FileMetadata = {\n    id: \"default-cover\",\n    name: \"cover-image.jpg\",\n    size: 2048000,\n    type: \"image/jpeg\",\n    url: \"https://picsum.photos/1000/800?grayscale&random=3\",\n  }\n\n  const [coverImage, setCoverImage] = useState<FileWithPreview | null>({\n    id: defaultCoverImage.id,\n    file: defaultCoverImage,\n    preview: defaultCoverImage.url,\n  })\n\n  const [imageLoading, setImageLoading] = useState(true)\n  const [uploadProgress, setUploadProgress] = useState(0)\n  const [isUploading, setIsUploading] = useState(false)\n  const [uploadError, setUploadError] = useState<string | null>(null)\n\n  const [\n    { isDragging, errors },\n    {\n      handleDragEnter,\n      handleDragLeave,\n      handleDragOver,\n      handleDrop,\n      openFileDialog,\n      getInputProps,\n    },\n  ] = useFileUpload({\n    maxFiles: 1,\n    maxSize,\n    accept,\n    multiple: false,\n    onFilesChange: (files) => {\n      if (files.length > 0) {\n        setImageLoading(true)\n        setIsUploading(true)\n        setUploadProgress(0)\n        setUploadError(null)\n        setCoverImage(files[0])\n        onImageChange?.(files[0].file as File)\n\n        // Simulate upload progress\n        simulateUpload()\n      }\n    },\n  })\n\n  // Simulate upload progress\n  const simulateUpload = () => {\n    const interval = setInterval(() => {\n      setUploadProgress((prev) => {\n        if (prev >= 100) {\n          clearInterval(interval)\n          setIsUploading(false)\n\n          // Simulate occasional upload failure (10% chance)\n          if (Math.random() < 0.1) {\n            setUploadError(\"Upload failed. Please try again.\")\n            return 0\n          }\n\n          return 100\n        }\n\n        // Random progress increment between 5-15%\n        const increment = Math.random() * 10 + 5\n        return Math.min(prev + increment, 100)\n      })\n    }, 200)\n  }\n\n  const removeCoverImage = () => {\n    setCoverImage(null)\n    setImageLoading(false)\n    setIsUploading(false)\n    setUploadProgress(0)\n    setUploadError(null)\n    onImageChange?.(null)\n  }\n\n  const retryUpload = () => {\n    if (coverImage) {\n      setUploadError(null)\n      setIsUploading(true)\n      setUploadProgress(0)\n      simulateUpload()\n    }\n  }\n\n  const hasImage = coverImage && coverImage.preview\n\n  return (\n    <div className={cn(\"w-full space-y-4\", className)}>\n      {/* Cover Upload Area */}\n      <div\n        className={cn(\n          \"group border-border rounded-4xl relative overflow-hidden border transition-all duration-200\",\n          isDragging\n            ? \"border-primary bg-primary/5 border-dashed\"\n            : hasImage\n              ? \"border-border bg-background hover:border-primary/50\"\n              : \"border-muted-foreground/25 bg-muted/30 hover:border-primary hover:bg-primary/5 border-dashed\"\n        )}\n        onDragEnter={handleDragEnter}\n        onDragLeave={handleDragLeave}\n        onDragOver={handleDragOver}\n        onDrop={handleDrop}\n      >\n        {/* Hidden file input */}\n        <input {...getInputProps()} className=\"sr-only\" />\n\n        {hasImage ? (\n          <>\n            {/* Cover Image Display */}\n            <div className=\"relative aspect-21/9 w-full\">\n              {/* Loading placeholder */}\n              {imageLoading && (\n                <div className=\"bg-muted absolute inset-0 flex animate-pulse items-center justify-center\">\n                  <div className=\"text-muted-foreground flex flex-col items-center gap-2\">\n                    <IconPlaceholder\n                      lucide=\"ImageIcon\"\n                      tabler=\"IconPhoto\"\n                      hugeicons=\"ImageIcon\"\n                      phosphor=\"ImageIcon\"\n                      remixicon=\"RiImageLine\"\n                      className=\"size-5\"\n                    />\n                    <span className=\"text-sm\">Loading image...</span>\n                  </div>\n                </div>\n              )}\n\n              {/* Actual image */}\n              <img\n                src={coverImage.preview}\n                alt=\"Cover\"\n                className={cn(\n                  \"h-full w-full object-cover transition-opacity duration-300\",\n                  imageLoading ? \"opacity-0\" : \"opacity-100\"\n                )}\n                onLoad={() => setImageLoading(false)}\n                onError={() => setImageLoading(false)}\n              />\n\n              {/* Overlay on hover */}\n              <div className=\"absolute inset-0 bg-black/0 transition-all duration-200 group-hover:bg-black/40\" />\n\n              {/* Action buttons overlay */}\n              <div className=\"absolute inset-0 flex items-center justify-center opacity-0 transition-opacity duration-200 group-hover:opacity-100\">\n                <div className=\"flex gap-2\">\n                  <Button onClick={openFileDialog} size=\"sm\" variant=\"outline\">\n                    <IconPlaceholder\n                      lucide=\"UploadIcon\"\n                      tabler=\"IconUpload\"\n                      hugeicons=\"Upload01Icon\"\n                      phosphor=\"UploadSimple\"\n                      remixicon=\"RiUpload2Line\"\n                    />\n                    Change Cover\n                  </Button>\n                  <Button onClick={removeCoverImage} size=\"sm\">\n                    <IconPlaceholder\n                      lucide=\"XIcon\"\n                      tabler=\"IconX\"\n                      hugeicons=\"MultiplicationSignIcon\"\n                      phosphor=\"XIcon\"\n                      remixicon=\"RiCloseLine\"\n                    />\n                    Remove\n                  </Button>\n                </div>\n              </div>\n\n              {/* Upload progress */}\n              {isUploading && (\n                <div className=\"absolute inset-0 flex items-center justify-center bg-black/40\">\n                  <div className=\"relative\">\n                    <svg className=\"size-16 -rotate-90\" viewBox=\"0 0 64 64\">\n                      <circle\n                        cx=\"32\"\n                        cy=\"32\"\n                        r=\"28\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"4\"\n                        className=\"text-white/20\"\n                      />\n                      <circle\n                        cx=\"32\"\n                        cy=\"32\"\n                        r=\"28\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        strokeWidth=\"4\"\n                        strokeDasharray={`${2 * Math.PI * 28}`}\n                        strokeDashoffset={`${2 * Math.PI * 28 * (1 - uploadProgress / 100)}`}\n                        className=\"text-white transition-all duration-300\"\n                        strokeLinecap=\"round\"\n                      />\n                    </svg>\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <span className=\"text-sm font-medium text-white\">\n                        {Math.round(uploadProgress)}%\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          </>\n        ) : (\n          /* Empty State */\n          <div\n            className=\"flex aspect-21/9 w-full cursor-pointer flex-col items-center justify-center gap-4 p-8 text-center\"\n            onClick={openFileDialog}\n          >\n            <div className=\"bg-primary/10 rounded-full p-4\">\n              <IconPlaceholder\n                lucide=\"CloudUploadIcon\"\n                tabler=\"IconCloudUpload\"\n                hugeicons=\"CloudUploadIcon\"\n                phosphor=\"CloudArrowUpIcon\"\n                remixicon=\"RiUploadCloud2Line\"\n                className=\"text-primary size-8\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <h3 className=\"text-lg font-semibold\">Upload Cover Image</h3>\n              <p className=\"text-muted-foreground text-sm\">\n                Drag and drop an image here, or click to browse\n              </p>\n              <p className=\"text-muted-foreground text-xs\">\n                Recommended size: 1200x514px • Max size: 5MB\n              </p>\n            </div>\n\n            <Button variant=\"outline\" size=\"sm\">\n              <IconPlaceholder\n                lucide=\"ImageIcon\"\n                tabler=\"IconPhoto\"\n                hugeicons=\"ImageIcon\"\n                phosphor=\"ImageIcon\"\n                remixicon=\"RiImageLine\"\n              />\n              Browse Files\n            </Button>\n          </div>\n        )}\n      </div>\n\n      {/* Error Messages */}\n      {errors.length > 0 && (\n        <Alert variant=\"destructive\" className=\"mt-5\">\n          <IconPlaceholder\n            lucide=\"CircleAlertIcon\"\n            tabler=\"IconAlertCircle\"\n            hugeicons=\"AlertCircleIcon\"\n            phosphor=\"WarningCircleIcon\"\n            remixicon=\"RiErrorWarningLine\"\n          />\n          <AlertTitle>File upload error(s)</AlertTitle>\n          <AlertDescription>\n            {errors.map((error, index) => (\n              <p key={index} className=\"last:mb-0\">\n                {error}\n              </p>\n            ))}\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Upload Error */}\n      {uploadError && (\n        <Alert variant=\"destructive\" className=\"mt-5\">\n          <IconPlaceholder\n            lucide=\"CircleAlertIcon\"\n            tabler=\"IconAlertCircle\"\n            hugeicons=\"AlertCircleIcon\"\n            phosphor=\"WarningCircleIcon\"\n            remixicon=\"RiErrorWarningLine\"\n          />\n          <AlertTitle>Upload failed</AlertTitle>\n          <AlertDescription>\n            <p>{uploadError}</p>\n            <Button onClick={retryUpload} size=\"sm\">\n              Retry Upload\n            </Button>\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Upload Tips */}\n      <div className=\"bg-muted/50 rounded-lg p-4\">\n        <h4 className=\"mb-2 text-sm font-medium\">Cover Image Guidelines</h4>\n        <ul className=\"text-muted-foreground space-y-1 text-xs\">\n          <li>• Use high-quality images with good lighting and composition</li>\n          <li>• Recommended aspect ratio: 21:9 (ultrawide) for best results</li>\n          <li>• Avoid images with important content near the edges</li>\n          <li>• Supported formats: JPG, PNG, WebP</li>\n        </ul>\n      </div>\n    </div>\n  )\n}","target":"components/patterns/p-file-upload-10.tsx"}]}