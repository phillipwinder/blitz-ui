{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"data-grid-table","type":"registry:ui","title":"Data Grid Table","description":"","dependencies":["@tanstack/react-table","class-variance-authority"],"registryDependencies":["checkbox"],"files":[{"path":"data-grid-table.tsx","type":"registry:ui","content":"\"use client\"\n\nimport { CSSProperties, Fragment, ReactNode } from \"react\"\nimport { useDataGrid } from \"@/components/reui/data-grid/data-grid\"\nimport {\n  Cell,\n  Column,\n  flexRender,\n  Header,\n  HeaderGroup,\n  Row,\n} from \"@tanstack/react-table\"\nimport { cva } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Checkbox } from \"@/components/ui/checkbox\"\n\nconst headerCellSpacingVariants = cva(\"\", {\n  variants: {\n    size: {\n      dense:\n        \"px-2 h-7\",\n      default:\n        \"px-2.5\",\n    },\n  },\n  defaultVariants: {\n    size: \"default\",\n  },\n})\n\nconst bodyCellSpacingVariants = cva(\"\", {\n  variants: {\n    size: {\n      dense:\n        \"px-2 py-1\",\n      default:\n        \"px-2.5 py-1.5\",\n    },\n  },\n  defaultVariants: {\n    size: \"default\",\n  },\n})\n\nfunction getPinningStyles<TData>(column: Column<TData>): CSSProperties {\n  const isPinned = column.getIsPinned()\n\n  return {\n    left: isPinned === \"left\" ? `${column.getStart(\"left\")}px` : undefined,\n    right: isPinned === \"right\" ? `${column.getAfter(\"right\")}px` : undefined,\n    position: isPinned ? \"sticky\" : \"relative\",\n    width: column.getSize(),\n    zIndex: isPinned ? 1 : 0,\n  }\n}\n\nfunction DataGridTableBase({ children }: { children: ReactNode }) {\n  const { props, table } = useDataGrid()\n\n  return (\n    <table\n      data-slot=\"data-grid-table\"\n      className={cn(\n        \"text-foreground text-xs/relaxed w-full min-w-full caption-bottom text-left align-middle font-normal rtl:text-right\",\n        props.tableLayout?.width === \"auto\" ? \"table-auto\" : \"table-fixed\",\n        !props.tableLayout?.columnsResizable && \"\",\n        !props.tableLayout?.columnsDraggable &&\n          \"border-separate border-spacing-0\",\n        props.tableClassNames?.base\n      )}\n      style={\n        props.tableLayout?.columnsResizable\n          ? { width: table.getTotalSize() }\n          : undefined\n      }\n    >\n      {children}\n    </table>\n  )\n}\n\nfunction DataGridTableHead({ children }: { children: ReactNode }) {\n  const { props } = useDataGrid()\n\n  return (\n    <thead\n      className={cn(\n        props.tableClassNames?.header,\n        props.tableLayout?.headerSticky && props.tableClassNames?.headerSticky\n      )}\n    >\n      {children}\n    </thead>\n  )\n}\n\nfunction DataGridTableHeadRow<TData>({\n  children,\n  headerGroup,\n}: {\n  children: ReactNode\n  headerGroup: HeaderGroup<TData>\n}) {\n  const { props } = useDataGrid()\n\n  return (\n    <tr\n      key={headerGroup.id}\n      className={cn(\n        \"bg-muted/40\",\n        props.tableLayout?.headerBorder && \"[&>th]:border-b\",\n        props.tableLayout?.cellBorder && \"*:last:border-e-0\",\n        props.tableLayout?.stripped && \"bg-transparent\",\n        props.tableLayout?.headerBackground === false && \"bg-transparent\",\n        props.tableClassNames?.headerRow\n      )}\n    >\n      {children}\n    </tr>\n  )\n}\n\nfunction DataGridTableHeadRowCell<TData>({\n  children,\n  header,\n  dndRef,\n  dndStyle,\n}: {\n  children: ReactNode\n  header: Header<TData, unknown>\n  dndRef?: React.Ref<HTMLTableCellElement>\n  dndStyle?: CSSProperties\n}) {\n  const { props } = useDataGrid()\n\n  const { column } = header\n  const isPinned = column.getIsPinned()\n  const isLastLeftPinned = isPinned === \"left\" && column.getIsLastColumn(\"left\")\n  const isFirstRightPinned =\n    isPinned === \"right\" && column.getIsFirstColumn(\"right\")\n  const headerCellSpacing = headerCellSpacingVariants({\n    size: props.tableLayout?.dense ? \"dense\" : \"default\",\n  })\n\n  return (\n    <th\n      key={header.id}\n      ref={dndRef}\n      style={{\n        ...((props.tableLayout?.width === \"fixed\" ||\n          props.tableLayout?.columnsResizable) && {\n          width: header.getSize(),\n        }),\n        ...(props.tableLayout?.columnsPinnable &&\n          column.getCanPin() &&\n          getPinningStyles(column)),\n        ...(dndStyle ? dndStyle : null),\n      }}\n      data-pinned={isPinned || undefined}\n      data-last-col={\n        isLastLeftPinned ? \"left\" : isFirstRightPinned ? \"right\" : undefined\n      }\n      className={cn(\n        \"text-secondary-foreground/80 h-8 relative text-left align-middle font-normal rtl:text-right [&:has([role=checkbox])]:pe-0\",\n        headerCellSpacing,\n        props.tableLayout?.cellBorder && \"border-e\",\n        props.tableLayout?.columnsResizable &&\n          column.getCanResize() &&\n          \"truncate\",\n        props.tableLayout?.columnsPinnable &&\n          column.getCanPin() &&\n          \"[&[data-pinned][data-last-col]]:border-border data-pinned:bg-muted/90 data-pinned:backdrop-blur-xs [&:not([data-pinned]):has(+[data-pinned])_div.cursor-col-resize:last-child]:opacity-0 [&[data-last-col=left]_div.cursor-col-resize:last-child]:opacity-0 [&[data-pinned=left][data-last-col=left]]:border-e! [&[data-pinned=right]:last-child_div.cursor-col-resize:last-child]:opacity-0 [&[data-pinned=right][data-last-col=right]]:border-s!\",\n        header.column.columnDef.meta?.headerClassName,\n        column.getIndex() === 0 ||\n          column.getIndex() === header.headerGroup.headers.length - 1\n          ? props.tableClassNames?.edgeCell\n          : \"\"\n      )}\n    >\n      {children}\n    </th>\n  )\n}\n\nfunction DataGridTableHeadRowCellResize<TData>({\n  header,\n}: {\n  header: Header<TData, unknown>\n}) {\n  const { column } = header\n\n  return (\n    <div\n      {...{\n        onDoubleClick: () => column.resetSize(),\n        onMouseDown: header.getResizeHandler(),\n        onTouchStart: header.getResizeHandler(),\n        className:\n          \"absolute top-0 h-full w-4 cursor-col-resize user-select-none touch-none -end-2 z-10 flex justify-center before:absolute before:w-px before:inset-y-0 before:bg-border before:-translate-x-px\",\n      }}\n    />\n  )\n}\n\nfunction DataGridTableRowSpacer() {\n  return <tbody aria-hidden=\"true\" className=\"h-2\"></tbody>\n}\n\nfunction DataGridTableBody({ children }: { children: ReactNode }) {\n  const { props } = useDataGrid()\n\n  return (\n    <tbody\n      className={cn(\n        \"[&_tr:last-child]:border-0\",\n        props.tableLayout?.rowRounded &&\n          \"[&_td:first-child]:rounded-l-4xl\",\n        props.tableLayout?.rowRounded &&\n          \"[&_td:last-child]:rounded-r-4xl\",\n        props.tableClassNames?.body\n      )}\n    >\n      {children}\n    </tbody>\n  )\n}\n\nfunction DataGridTableBodyRowSkeleton({ children }: { children: ReactNode }) {\n  const { table, props } = useDataGrid()\n\n  return (\n    <tr\n      className={cn(\n        \"hover:bg-muted/40 data-[state=selected]:bg-muted/50\",\n        props.onRowClick && \"cursor-pointer\",\n        !props.tableLayout?.stripped &&\n          props.tableLayout?.rowBorder &&\n          \"border-border border-b [&:not(:last-child)>td]:border-b\",\n        props.tableLayout?.cellBorder && \"*:last:border-e-0\",\n        props.tableLayout?.stripped &&\n          \"odd:bg-muted/90 odd:hover:bg-muted hover:bg-transparent\",\n        table.options.enableRowSelection && \"*:first:relative\",\n        props.tableClassNames?.bodyRow\n      )}\n    >\n      {children}\n    </tr>\n  )\n}\n\nfunction DataGridTableBodyRowSkeletonCell<TData>({\n  children,\n  column,\n}: {\n  children: ReactNode\n  column: Column<TData>\n}) {\n  const { props, table } = useDataGrid()\n  const bodyCellSpacing = bodyCellSpacingVariants({\n    size: props.tableLayout?.dense ? \"dense\" : \"default\",\n  })\n\n  return (\n    <td\n      style={\n        props.tableLayout?.columnsResizable\n          ? { width: column.getSize() }\n          : undefined\n      }\n      className={cn(\n        \"align-middle\",\n        bodyCellSpacing,\n        props.tableLayout?.cellBorder && \"border-e\",\n        props.tableLayout?.columnsResizable &&\n          column.getCanResize() &&\n          \"truncate\",\n        column.columnDef.meta?.cellClassName,\n        props.tableLayout?.columnsPinnable &&\n          column.getCanPin() &&\n          '[&[data-pinned][data-last-col]]:border-border data-pinned:bg-background/90 data-pinned:backdrop-blur-xs\" [&[data-pinned=left][data-last-col=left]]:border-e! [&[data-pinned=right][data-last-col=right]]:border-s!',\n        column.getIndex() === 0 ||\n          column.getIndex() === table.getVisibleFlatColumns().length - 1\n          ? props.tableClassNames?.edgeCell\n          : \"\"\n      )}\n    >\n      {children}\n    </td>\n  )\n}\n\nfunction DataGridTableBodyRow<TData>({\n  children,\n  row,\n  dndRef,\n  dndStyle,\n}: {\n  children: ReactNode\n  row: Row<TData>\n  dndRef?: React.Ref<HTMLTableRowElement>\n  dndStyle?: CSSProperties\n}) {\n  const { props, table } = useDataGrid()\n\n  return (\n    <tr\n      ref={dndRef}\n      style={{ ...(dndStyle ? dndStyle : null) }}\n      data-state={\n        table.options.enableRowSelection && row.getIsSelected()\n          ? \"selected\"\n          : undefined\n      }\n      onClick={() => props.onRowClick && props.onRowClick(row.original)}\n      className={cn(\n        \"hover:bg-muted/40 data-[state=selected]:bg-muted/50\",\n        props.onRowClick && \"cursor-pointer\",\n        !props.tableLayout?.stripped &&\n          props.tableLayout?.rowBorder &&\n          \"border-border border-b [&:not(:last-child)>td]:border-b\",\n        props.tableLayout?.cellBorder && \"*:last:border-e-0\",\n        props.tableLayout?.stripped &&\n          \"odd:bg-muted/90 odd:hover:bg-muted hover:bg-transparent\",\n        table.options.enableRowSelection && \"*:first:relative\",\n        props.tableClassNames?.bodyRow\n      )}\n    >\n      {children}\n    </tr>\n  )\n}\n\nfunction DataGridTableBodyRowExpandded<TData>({ row }: { row: Row<TData> }) {\n  const { props, table } = useDataGrid()\n\n  return (\n    <tr\n      className={cn(\n        props.tableLayout?.rowBorder && \"[&:not(:last-child)>td]:border-b\"\n      )}\n    >\n      <td colSpan={row.getVisibleCells().length}>\n        {table\n          .getAllColumns()\n          .find((column) => column.columnDef.meta?.expandedContent)\n          ?.columnDef.meta?.expandedContent?.(row.original)}\n      </td>\n    </tr>\n  )\n}\n\nfunction DataGridTableBodyRowCell<TData>({\n  children,\n  cell,\n  dndRef,\n  dndStyle,\n}: {\n  children: ReactNode\n  cell: Cell<TData, unknown>\n  dndRef?: React.Ref<HTMLTableCellElement>\n  dndStyle?: CSSProperties\n}) {\n  const { props } = useDataGrid()\n\n  const { column, row } = cell\n  const isPinned = column.getIsPinned()\n  const isLastLeftPinned = isPinned === \"left\" && column.getIsLastColumn(\"left\")\n  const isFirstRightPinned =\n    isPinned === \"right\" && column.getIsFirstColumn(\"right\")\n  const bodyCellSpacing = bodyCellSpacingVariants({\n    size: props.tableLayout?.dense ? \"dense\" : \"default\",\n  })\n\n  return (\n    <td\n      key={cell.id}\n      ref={dndRef}\n      {...(props.tableLayout?.columnsDraggable && !isPinned ? { cell } : {})}\n      style={{\n        ...(props.tableLayout?.columnsResizable && {\n          width: column.getSize(),\n        }),\n        ...(props.tableLayout?.columnsPinnable &&\n          column.getCanPin() &&\n          getPinningStyles(column)),\n        ...(dndStyle ? dndStyle : null),\n      }}\n      data-pinned={isPinned || undefined}\n      data-last-col={\n        isLastLeftPinned ? \"left\" : isFirstRightPinned ? \"right\" : undefined\n      }\n      className={cn(\n        \"align-middle\",\n        bodyCellSpacing,\n        props.tableLayout?.cellBorder && \"border-e\",\n        props.tableLayout?.columnsResizable &&\n          column.getCanResize() &&\n          \"truncate\",\n        cell.column.columnDef.meta?.cellClassName,\n        props.tableLayout?.columnsPinnable &&\n          column.getCanPin() &&\n          '[&[data-pinned][data-last-col]]:border-border data-pinned:bg-background/90 data-pinned:backdrop-blur-xs\" [&[data-pinned=left][data-last-col=left]]:border-e! [&[data-pinned=right][data-last-col=right]]:border-s!',\n        column.getIndex() === 0 ||\n          column.getIndex() === row.getVisibleCells().length - 1\n          ? props.tableClassNames?.edgeCell\n          : \"\"\n      )}\n    >\n      {children}\n    </td>\n  )\n}\n\nfunction DataGridTableEmpty() {\n  const { table, props } = useDataGrid()\n  const totalColumns = table.getAllColumns().length\n\n  return (\n    <tr>\n      <td\n        colSpan={totalColumns}\n        className=\"text-muted-foreground text-xs/relaxed py-6 text-center\"\n      >\n        {props.emptyMessage || \"No data available\"}\n      </td>\n    </tr>\n  )\n}\n\nfunction DataGridTableLoader() {\n  const { props } = useDataGrid()\n\n  return (\n    <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2\">\n      <div className=\"text-muted-foreground bg-card rounded-md text-xs/relaxed flex items-center gap-2 border px-4 py-2 leading-none font-medium\">\n        <svg\n          className=\"text-muted-foreground -ml-1 h-5 w-5 animate-spin\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n        >\n          <circle\n            className=\"opacity-25\"\n            cx=\"12\"\n            cy=\"12\"\n            r=\"10\"\n            stroke=\"currentColor\"\n            strokeWidth=\"3\"\n          ></circle>\n          <path\n            className=\"opacity-75\"\n            fill=\"currentColor\"\n            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n          ></path>\n        </svg>\n        {props.loadingMessage || \"Loading...\"}\n      </div>\n    </div>\n  )\n}\n\nfunction DataGridTableRowSelect<TData>({ row }: { row: Row<TData> }) {\n  return (\n    <>\n      <div\n        className={cn(\n          \"bg-primary absolute start-0 top-0 bottom-0 hidden w-[2px]\",\n          row.getIsSelected() && \"block\"\n        )}\n      ></div>\n      <Checkbox\n        checked={row.getIsSelected()}\n        onCheckedChange={(value) => row.toggleSelected(!!value)}\n        aria-label=\"Select row\"\n        className=\"align-[inherit]\"\n      />\n    </>\n  )\n}\n\nfunction DataGridTableRowSelectAll() {\n  const { table, recordCount, isLoading } = useDataGrid()\n\n  const isAllSelected = table.getIsAllPageRowsSelected()\n  const isSomeSelected = table.getIsSomePageRowsSelected()\n\n  return (\n    <Checkbox\n      checked={isAllSelected}\n      indeterminate={isSomeSelected && !isAllSelected}\n      disabled={isLoading || recordCount === 0}\n      onCheckedChange={(value) => table.toggleAllPageRowsSelected(!!value)}\n      aria-label=\"Select all\"\n      className=\"align-[inherit]\"\n    />\n  )\n}\n\nfunction DataGridTable<TData>() {\n  const { table, isLoading, props } = useDataGrid()\n  const pagination = table.getState().pagination\n\n  return (\n    <DataGridTableBase>\n      <DataGridTableHead>\n        {table\n          .getHeaderGroups()\n          .map((headerGroup: HeaderGroup<TData>, index) => {\n            return (\n              <DataGridTableHeadRow headerGroup={headerGroup} key={index}>\n                {headerGroup.headers.map((header, index) => {\n                  const { column } = header\n\n                  return (\n                    <DataGridTableHeadRowCell header={header} key={index}>\n                      {header.isPlaceholder\n                        ? null\n                        : flexRender(\n                            header.column.columnDef.header,\n                            header.getContext()\n                          )}\n                      {props.tableLayout?.columnsResizable &&\n                        column.getCanResize() && (\n                          <DataGridTableHeadRowCellResize header={header} />\n                        )}\n                    </DataGridTableHeadRowCell>\n                  )\n                })}\n              </DataGridTableHeadRow>\n            )\n          })}\n      </DataGridTableHead>\n\n      {(props.tableLayout?.stripped || !props.tableLayout?.rowBorder) && (\n        <DataGridTableRowSpacer />\n      )}\n\n      <DataGridTableBody>\n        {isLoading &&\n        props.loadingMode === \"skeleton\" &&\n        pagination?.pageSize ? (\n          // Show skeleton loading immediately\n          Array.from({ length: pagination.pageSize }).map((_, rowIndex) => (\n            <DataGridTableBodyRowSkeleton key={rowIndex}>\n              {table.getVisibleFlatColumns().map((column, colIndex) => {\n                return (\n                  <DataGridTableBodyRowSkeletonCell\n                    column={column}\n                    key={colIndex}\n                  >\n                    {column.columnDef.meta?.skeleton}\n                  </DataGridTableBodyRowSkeletonCell>\n                )\n              })}\n            </DataGridTableBodyRowSkeleton>\n          ))\n        ) : isLoading && props.loadingMode === \"spinner\" ? (\n          // Show spinner loading immediately\n          <tr>\n            <td colSpan={table.getVisibleFlatColumns().length} className=\"p-8\">\n              <div className=\"flex items-center justify-center\">\n                <svg\n                  className=\"text-muted-foreground mr-3 -ml-1 h-5 w-5 animate-spin\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <circle\n                    className=\"opacity-25\"\n                    cx=\"12\"\n                    cy=\"12\"\n                    r=\"10\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"4\"\n                  ></circle>\n                  <path\n                    className=\"opacity-75\"\n                    fill=\"currentColor\"\n                    d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n                  ></path>\n                </svg>\n                {props.loadingMessage || \"Loading...\"}\n              </div>\n            </td>\n          </tr>\n        ) : table.getRowModel().rows.length ? (\n          // Show actual data when not loading\n          table.getRowModel().rows.map((row: Row<TData>, index) => {\n            return (\n              <Fragment key={row.id}>\n                <DataGridTableBodyRow row={row} key={index}>\n                  {row\n                    .getVisibleCells()\n                    .map((cell: Cell<TData, unknown>, colIndex) => {\n                      return (\n                        <DataGridTableBodyRowCell cell={cell} key={colIndex}>\n                          {flexRender(\n                            cell.column.columnDef.cell,\n                            cell.getContext()\n                          )}\n                        </DataGridTableBodyRowCell>\n                      )\n                    })}\n                </DataGridTableBodyRow>\n                {row.getIsExpanded() && (\n                  <DataGridTableBodyRowExpandded row={row} />\n                )}\n              </Fragment>\n            )\n          })\n        ) : (\n          <DataGridTableEmpty />\n        )}\n      </DataGridTableBody>\n    </DataGridTableBase>\n  )\n}\n\nexport {\n  DataGridTable,\n  DataGridTableBase,\n  DataGridTableBody,\n  DataGridTableBodyRow,\n  DataGridTableBodyRowCell,\n  DataGridTableBodyRowExpandded,\n  DataGridTableBodyRowSkeleton,\n  DataGridTableBodyRowSkeletonCell,\n  DataGridTableEmpty,\n  DataGridTableHead,\n  DataGridTableHeadRow,\n  DataGridTableHeadRowCell,\n  DataGridTableHeadRowCellResize,\n  DataGridTableLoader,\n  DataGridTableRowSelect,\n  DataGridTableRowSelectAll,\n  DataGridTableRowSpacer,\n}","target":"component/reui/data-grid/data-grid-table.tsx"}]}