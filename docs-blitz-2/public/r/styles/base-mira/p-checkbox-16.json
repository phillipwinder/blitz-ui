{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"p-checkbox-16","type":"registry:block","title":"Nested checkbox group","description":"Nested checkbox group","dependencies":[],"registryDependencies":["checkbox","field"],"files":[{"path":"p-checkbox-16.tsx","type":"registry:block","content":"\"use client\"\n\nimport { useCallback, useState } from \"react\"\n\nimport { Checkbox } from \"@/components/ui/checkbox\"\nimport { Field, FieldLabel } from \"@/components/ui/field\"\n\ninterface Item {\n  id: string\n  label: string\n  children?: Item[]\n}\n\nconst data: Item[] = [\n  {\n    id: \"admin\",\n    label: \"Administration\",\n    children: [\n      {\n        id: \"user-management\",\n        label: \"User Management\",\n        children: [\n          { id: \"view-users\", label: \"View Users\" },\n          { id: \"create-users\", label: \"Create Users\" },\n          { id: \"edit-users\", label: \"Edit Users\" },\n        ],\n      },\n      {\n        id: \"role-management\",\n        label: \"Role Management\",\n        children: [\n          { id: \"view-roles\", label: \"View Roles\" },\n          { id: \"assign-roles\", label: \"Assign Roles\" },\n        ],\n      },\n    ],\n  },\n]\n\nexport function Pattern() {\n  const [checked, setChecked] = useState<Record<string, boolean>>({\n    \"view-users\": true,\n    \"create-users\": true,\n    \"view-roles\": true,\n  })\n\n  // Get all leaf nodes for a given node\n  const getLeafIds = useCallback((item: Item): string[] => {\n    if (!item.children) return [item.id]\n    return item.children.flatMap(getLeafIds)\n  }, [])\n\n  // Check if a node is fully checked\n  const isChecked = useCallback(\n    (item: Item): boolean => {\n      const leafIds = getLeafIds(item)\n      return leafIds.every((id) => checked[id])\n    },\n    [checked, getLeafIds]\n  )\n\n  // Check if a node is indeterminate\n  const isIndeterminate = useCallback(\n    (item: Item): boolean => {\n      const leafIds = getLeafIds(item)\n      const checkedCount = leafIds.filter((id) => checked[id]).length\n      return checkedCount > 0 && checkedCount < leafIds.length\n    },\n    [checked, getLeafIds]\n  )\n\n  const toggle = (item: Item) => {\n    const leafIds = getLeafIds(item)\n    const shouldCheck = !isChecked(item)\n\n    const nextChecked = { ...checked }\n    leafIds.forEach((id) => {\n      nextChecked[id] = shouldCheck\n    })\n    setChecked(nextChecked)\n  }\n\n  const renderItem = (item: Item, level = 0) => {\n    return (\n      <div key={item.id} className=\"flex flex-col gap-3\">\n        <Field orientation=\"horizontal\">\n          <Checkbox\n            id={item.id}\n            checked={isChecked(item)}\n            indeterminate={isIndeterminate(item)}\n            onCheckedChange={() => toggle(item)}\n          />\n          <FieldLabel\n            htmlFor={item.id}\n            className={level === 0 ? \"font-semibold\" : \"text-sm\"}\n          >\n            {item.label}\n          </FieldLabel>\n        </Field>\n\n        {item.children && (\n          <div className=\"ml-7 flex flex-col gap-3\">\n            {item.children.map((child) => renderItem(child, level + 1))}\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"mx-auto flex flex-col gap-3\">\n      {data.map((item) => renderItem(item))}\n    </div>\n  )\n}","target":"components/patterns/p-checkbox-16.tsx"}]}