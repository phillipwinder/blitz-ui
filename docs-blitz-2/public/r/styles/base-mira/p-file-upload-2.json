{"$schema":"https://ui.shadcn.com/schema/registry-item.json","name":"p-file-upload-2","type":"registry:block","title":"Avatar upload","description":"Avatar upload","dependencies":[],"registryDependencies":["https://reui.io/r/styles/base-mira/alert.json","button","https://reui.io/r/styles/base-mira/use-file-upload.json"],"files":[{"path":"p-file-upload-2.tsx","type":"registry:block","content":"\"use client\"\n\nimport {\n  formatBytes,\n  useFileUpload,\n  type FileWithPreview,\n} from \"@/hooks/use-file-upload\"\nimport {\n  Alert,\n  AlertDescription,\n  AlertTitle,\n} from \"@/components/reui/alert\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { IconPlaceholder } from \"@/app/(create)/components/icon-placeholder\"\n\ninterface AvatarUploadProps {\n  maxSize?: number\n  className?: string\n  onFileChange?: (file: FileWithPreview | null) => void\n  defaultAvatar?: string\n}\n\nexport function Pattern({\n  maxSize = 2 * 1024 * 1024, // 2MB\n  className,\n  onFileChange,\n  defaultAvatar,\n}: AvatarUploadProps) {\n  const [\n    { files, isDragging, errors },\n    {\n      removeFile,\n      handleDragEnter,\n      handleDragLeave,\n      handleDragOver,\n      handleDrop,\n      openFileDialog,\n      getInputProps,\n    },\n  ] = useFileUpload({\n    maxFiles: 1,\n    maxSize,\n    accept: \"image/*\",\n    multiple: false,\n    onFilesChange: (files) => {\n      onFileChange?.(files[0] || null)\n    },\n  })\n\n  const currentFile = files[0]\n  const previewUrl = currentFile?.preview || defaultAvatar\n\n  const handleRemove = () => {\n    if (currentFile) {\n      removeFile(currentFile.id)\n    }\n  }\n\n  return (\n    <div className={cn(\"flex flex-col items-center gap-4\", className)}>\n      {/* Avatar Preview */}\n      <div className=\"relative\">\n        <div\n          className={cn(\n            \"group/avatar relative h-24 w-24 cursor-pointer overflow-hidden rounded-full border border-dashed transition-colors\",\n            isDragging\n              ? \"border-primary bg-primary/5\"\n              : \"border-muted-foreground/25 hover:border-muted-foreground/20\",\n            previewUrl && \"border-solid\"\n          )}\n          onDragEnter={handleDragEnter}\n          onDragLeave={handleDragLeave}\n          onDragOver={handleDragOver}\n          onDrop={handleDrop}\n          onClick={openFileDialog}\n        >\n          <input {...getInputProps()} className=\"sr-only\" />\n\n          {previewUrl ? (\n            <img\n              src={previewUrl}\n              alt=\"Avatar\"\n              className=\"h-full w-full object-cover\"\n            />\n          ) : (\n            <div className=\"flex h-full w-full items-center justify-center\">\n              <IconPlaceholder\n                lucide=\"UserIcon\"\n                tabler=\"IconUser\"\n                hugeicons=\"UserIcon\"\n                phosphor=\"UserIcon\"\n                remixicon=\"RiUserLine\"\n                className=\"text-muted-foreground size-6\"\n              />\n            </div>\n          )}\n        </div>\n\n        {/* Remove Button - only show when file is uploaded */}\n        {currentFile && (\n          <Button\n            size=\"icon\"\n            variant=\"outline\"\n            onClick={handleRemove}\n            className=\"absolute end-0.5 top-0.5 z-10 size-6 rounded-full dark:bg-zinc-800 hover:dark:bg-zinc-700\"\n            aria-label=\"Remove avatar\"\n          >\n            <IconPlaceholder\n              lucide=\"XIcon\"\n              tabler=\"IconX\"\n              hugeicons=\"MultiplicationSignIcon\"\n              phosphor=\"XIcon\"\n              remixicon=\"RiCloseLine\"\n              className=\"size-3.5\"\n            />\n          </Button>\n        )}\n      </div>\n\n      {/* Upload Instructions */}\n      <div className=\"space-y-0.5 text-center\">\n        <p className=\"text-sm font-medium\">\n          {currentFile ? \"Avatar uploaded\" : \"Upload avatar\"}\n        </p>\n        <p className=\"text-muted-foreground text-xs\">\n          PNG, JPG up to {formatBytes(maxSize)}\n        </p>\n      </div>\n\n      {/* Error Messages */}\n      {errors.length > 0 && (\n        <Alert variant=\"destructive\" className=\"mt-5\">\n          <IconPlaceholder\n            lucide=\"CircleAlertIcon\"\n            tabler=\"IconAlertCircle\"\n            hugeicons=\"AlertCircleIcon\"\n            phosphor=\"WarningCircleIcon\"\n            remixicon=\"RiErrorWarningLine\"\n          />\n          <AlertTitle>File upload error(s)</AlertTitle>\n          <AlertDescription>\n            {errors.map((error, index) => (\n              <p key={index} className=\"last:mb-0\">\n                {error}\n              </p>\n            ))}\n          </AlertDescription>\n        </Alert>\n      )}\n    </div>\n  )\n}","target":"components/patterns/p-file-upload-2.tsx"}]}